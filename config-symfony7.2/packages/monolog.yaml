parameters:
  black_list_app_channels:
    - '!analytics'
    - '!game_session'
    - '!docker'
    - '!docker_messenger'
    - '!docker_monitor'
    - '!app_ws_server'
    - '!watchdog'
    - '!deprecation' # also exclude deprecation logs from main log file
  white_list_app_channels:
    - analytics
    - game_session
    - docker
    - docker_messenger
    - docker_monitor
    - app_ws_server
    - watchdog

monolog:
    channels:
        - deprecation # Deprecations are logged in the dedicated "deprecation" channel when it exists
        - game_session # file-based game session creation and loading log
        - analytics
        - docker
        - docker_messenger
        - docker_monitor
        - app_ws_server
        - watchdog
    handlers:
            # uncomment to get logging in your browser
            # you may have to allow bigger header sizes in your Web server configuration
            #firephp:
            #    type: firephp
            #    level: info
            #chromephp:
            #    type: chromephp
            #    level: info
        main:
            type: stream
            path: "%kernel.logs_dir%/%kernel.environment%.log"
            level: debug
            formatter: monolog.formatter.json
            channels: "%black_list_app_channels%"
            console:
                type: console
                process_psr_3_messages: false
            channels: "%white_list_app_channels%"
        analytics:
            type: stream
            path: "%kernel.logs_dir%/analytics.log"
            level: warning
            formatter: monolog.formatter.json
            channels: [ 'analytics' ]
        docker:
            type: stream
            path: '%kernel.logs_dir%/docker.log'
            level: warning
            formatter: monolog.formatter.json
            channels: ['docker', 'docker_messenger', 'docker_monitor']
            session_log_handler:
                type: service
                id: App\Logger\GameSessionLogger
                channels: [ "game_session" ]
                process_psr_3_messages:
                    enabled: true
        deprecation:
            type: rotating_file
            channels: ["deprecation"]
            path: "%kernel.logs_dir%/deprecation.log"
            max_files: 7
            formatter: monolog.formatter.json
        app_ws_server:
                type: stream
            path: '%kernel.logs_dir%/app-ws-server.log'
            level: warning
            formatter: monolog.formatter.json
            channels: ['app_ws_server']
        watchdog:
                type: stream
            path: '%kernel.logs_dir%/watchdog.log'
            level: warning
            formatter: monolog.formatter.json
            channels: ['watchdog']

when@prod:
    monolog:
        handlers:
            main:
                type: rotating_file
                path: "%kernel.logs_dir%/%kernel.environment%.log"
                level: error
                formatter: monolog.formatter.json
                max_files: 7
                channels: "%black_list_app_channels%"